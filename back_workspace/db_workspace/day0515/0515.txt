SQL> select d.deptno, count(empno)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno;

    DEPTNO COUNT(EMPNO)                                                         
---------- ------------                                                         
        10            3                                                         
        20            5                                                         
        30            6                                                         
        40            0                                                         

SQL> select *
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno;
select *
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select *
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  ;

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      7782 CLARK                MANAGER                  7839 81/06/09          
      2450                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7839 KING                 PRESIDENT                     81/11/17          
      5000                    10         10 ACCOUNTING                          
NEW YORK                                                                        

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
      7934 MILLER               CLERK                    7782 82/01/23          
      1300                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7566 JONES                MANAGER                  7839 81/04/02          
      2975                    20         20 RESEARCH                            

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
DALLAS                                                                          
                                                                                
      7902 FORD                 ANALYST                  7566 81/12/03          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7876 ADAMS                CLERK                    7788 87/05/23          

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      1100                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7369 SMITH                CLERK                    7902 80/12/17          
       800                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7521 WARD                 SALESMAN                 7698 81/02/22          
      1250        500         30         30 SALES                               
CHICAGO                                                                         

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08          
      1500          0         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20          
      1600        300         30         30 SALES                               

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
CHICAGO                                                                         
                                                                                
      7900 JAMES                CLERK                    7698 81/12/03          
       950                    30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01          

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      2850                    30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7654 MARTIN               SALESMAN                 7698 81/09/28          
      1250       1400         30         30 SALES                               
CHICAGO                                                                         
                                                                                

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
                                         40 OPERATIONS                          
BOSTON                                                                          
                                                                                

15 rows selected.

SQL> select d.deptno, count(empno)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno;

    DEPTNO COUNT(EMPNO)                                                         
---------- ------------                                                         
        10            3                                                         
        20            5                                                         
        30            6                                                         
        40            0                                                         

SQL> SET PAGESIZE 30
SQL> select * from emp e right outer join dept d on e.deptno = d.deptno ;

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      7782 CLARK                MANAGER                  7839 81/06/09          
      2450                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7839 KING                 PRESIDENT                     81/11/17          
      5000                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7934 MILLER               CLERK                    7782 82/01/23          
      1300                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7566 JONES                MANAGER                  7839 81/04/02          
      2975                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7902 FORD                 ANALYST                  7566 81/12/03          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7876 ADAMS                CLERK                    7788 87/05/23          
      1100                    20         20 RESEARCH                            
DALLAS                                                                          

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
      7369 SMITH                CLERK                    7902 80/12/17          
       800                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7521 WARD                 SALESMAN                 7698 81/02/22          
      1250        500         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08          
      1500          0         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20          
      1600        300         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7900 JAMES                CLERK                    7698 81/12/03          
       950                    30         30 SALES                               

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
CHICAGO                                                                         
                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01          
      2850                    30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7654 MARTIN               SALESMAN                 7698 81/09/28          
      1250       1400         30         30 SALES                               
CHICAGO                                                                         
                                                                                
                                                                                
                                         40 OPERATIONS                          
BOSTON                                                                          
                                                                                

15 rows selected.

SQL> select * from emp e right outer join dept d on e.deptno = d.deptno ;

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      7782 CLARK                MANAGER                  7839 81/06/09          
      2450                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7839 KING                 PRESIDENT                     81/11/17          
      5000                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7934 MILLER               CLERK                    7782 82/01/23          
      1300                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7566 JONES                MANAGER                  7839 81/04/02          
      2975                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7902 FORD                 ANALYST                  7566 81/12/03          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7876 ADAMS                CLERK                    7788 87/05/23          
      1100                    20         20 RESEARCH                            
DALLAS                                                                          

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
      7369 SMITH                CLERK                    7902 80/12/17          
       800                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7521 WARD                 SALESMAN                 7698 81/02/22          
      1250        500         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08          
      1500          0         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20          
      1600        300         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7900 JAMES                CLERK                    7698 81/12/03          
       950                    30         30 SALES                               

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
CHICAGO                                                                         
                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01          
      2850                    30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7654 MARTIN               SALESMAN                 7698 81/09/28          
      1250       1400         30         30 SALES                               
CHICAGO                                                                         
                                                                                
                                                                                
                                         40 OPERATIONS                          
BOSTON                                                                          
                                                                                

15 rows selected.

SQL> select * from emp e right outer join dept d on e.deptno = d.deptno ;

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
      7782 CLARK                MANAGER                  7839 81/06/09          
      2450                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7839 KING                 PRESIDENT                     81/11/17          
      5000                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7934 MILLER               CLERK                    7782 82/01/23          
      1300                    10         10 ACCOUNTING                          
NEW YORK                                                                        
                                                                                
      7566 JONES                MANAGER                  7839 81/04/02          
      2975                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7902 FORD                 ANALYST                  7566 81/12/03          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7876 ADAMS                CLERK                    7788 87/05/23          
      1100                    20         20 RESEARCH                            
DALLAS                                                                          

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
                                                                                
      7369 SMITH                CLERK                    7902 80/12/17          
       800                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20         20 RESEARCH                            
DALLAS                                                                          
                                                                                
      7521 WARD                 SALESMAN                 7698 81/02/22          
      1250        500         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08          
      1500          0         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20          
      1600        300         30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7900 JAMES                CLERK                    7698 81/12/03          
       950                    30         30 SALES                               

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO     DEPTNO DNAME                               
---------- ---------- ---------- ---------- ----------------------------        
LOC                                                                             
--------------------------                                                      
CHICAGO                                                                         
                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01          
      2850                    30         30 SALES                               
CHICAGO                                                                         
                                                                                
      7654 MARTIN               SALESMAN                 7698 81/09/28          
      1250       1400         30         30 SALES                               
CHICAGO                                                                         
                                                                                
                                                                                
                                         40 OPERATIONS                          
BOSTON                                                                          
                                                                                

15 rows selected.

SQL> set linesize 1000
SQL> select * from emp e right outer join dept d on e.deptno = d.deptno ;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                        LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ---------------------------- --------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                40 OPERATIONS                   BOSTON                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

15 rows selected.

SQL> -- 조인은 부모자식간 데이터 조합이지만 union은 전혀 관련성이 없는 데이터를 조합
SQL> -- union
SQL> select ename, sal from emp
  2  union
  3  select dname, deptno from dept
  4  ;

ENAME                               SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ACCOUNTING                           10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ADAMS                              1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ALLEN                              1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
BLAKE                              2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
CLARK                              2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
FORD                               3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
JAMES                               950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
JONES                              2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
KING                               5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
MARTIN                             1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
MILLER                             1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
OPERATIONS                           40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
RESEARCH                             20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
SALES                                30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
SCOTT                              3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
SMITH                               800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
TURNER                             1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
WARD                               1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

18 rows selected.

SQL> SELECT ENAME, D.DEPTNO, DNAME, LOC
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO;

ENAME                    DEPTNO DNAME                        LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-------------------- ---------- ---------------------------- --------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
CLARK                        10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
KING                         10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
MILLER                       10 ACCOUNTING                   NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
JONES                        20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
FORD                         20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
ADAMS                        20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
SMITH                        20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
SCOTT                        20 RESEARCH                     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
WARD                         30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
TURNER                       30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ALLEN                        30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
JAMES                        30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
BLAKE                        30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN                       30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

14 rows selected.

SQL> SELECT D.DEPTNO, COUNT(*)
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  GROUP BY D.DEPTNO
  5  ;

    DEPTNO   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20          5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        10          3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT D.DEPTNO, COUNT(EMPNO)
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  GROUP BY D.DEPTNO
  5  HAVING COUNT(EMPNO) > 5;

    DEPTNO COUNT(EMPNO)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30            6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> SELECT D.DEPTNO, COUNT(EMPNO)
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  GROUP BY D.DEPTNO
  5  HAVING COUNT(EMPNO) > (
  6  SELECT COUNT(*)
  7  FROM EMP
  8  WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'SMITH'))
  9  ;

    DEPTNO COUNT(EMPNO)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30            6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> SELECT DEPTNO, DNAME, LOC
  2  FROM DEPT
  3  WHERE DEPTNO IN (
  4  SELECT D.DEPTNO, COUNT(EMPNO)
  5  FROM EMP E JOIN DEPT D
  6  ON E.DEPTNO = D.DEPTNO
  7  GROUP BY D.DEPTNO
  8  HAVING COUNT(EMPNO) > (
  9  SELECT COUNT(*)
 10  FROM EMP
 11  WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'SMITH')
 12  )
 13  );
SELECT D.DEPTNO, COUNT(EMPNO)
*
ERROR at line 4:
ORA-00913: too many values 


SQL> SELECT DEPTNO, DNAME, LOC
  2  FROM DEPT
  3  WHERE DEPTNO IN (
  4  SELECT D.DEPTNO
  5  FROM EMP E JOIN DEPT D
  6  ON E.DEPTNO = D.DEPTNO
  7  GROUP BY D.DEPTNO
  8  HAVING COUNT(EMPNO) > (
  9  SELECT COUNT(*)
 10  FROM EMP
 11  WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'SMITH')
 12  )
 13  );

    DEPTNO DNAME                        LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
---------- ---------------------------- --------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        30 SALES                        CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> SELECT * FROM EMP
  2  ;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

14 rows selected.

SQL> SELECT ENAME, DNAME, SAL
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO;

ENAME                DNAME                               SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------- ---------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
CLARK                ACCOUNTING                         2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
KING                 ACCOUNTING                         5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
MILLER               ACCOUNTING                         1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
JONES                RESEARCH                           2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
FORD                 RESEARCH                           3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
ADAMS                RESEARCH                           1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
SMITH                RESEARCH                            800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
SCOTT                RESEARCH                           3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
WARD                 SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
TURNER               SALES                              1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
ALLEN                SALES                              1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
JAMES                SALES                               950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
BLAKE                SALES                              2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
MARTIN               SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

14 rows selected.

SQL> SELECT ENAME, DNAME, SAL
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'ALLEN');

ENAME                DNAME                               SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------- ---------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
ALLEN                SALES                              1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
WARD                 SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
JAMES                SALES                               950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
BLAKE                SALES                              2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
TURNER               SALES                              1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
MARTIN               SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

6 rows selected.

SQL> SELECT ENAME, DNAME, SAL
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  5  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  6  ;

ENAME                DNAME                               SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------- ---------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
ALLEN                SALES                              1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
WARD                 SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
MARTIN               SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
BLAKE                SALES                              2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
TURNER               SALES                              1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

SQL> SELECT DEPTNO, COUNT(*)
  2  FROM (
  3  SELECT ENAME, DNAME, SAL
  4  FROM EMP E JOIN DEPT D
  5  ON E.DEPTNO = D.DEPTNO
  6  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  7  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  8  )
  9  GROUP BY DEPTNO
 10  ;
GROUP BY DEPTNO
         *
ERROR at line 9:
ORA-00904: "DEPTNO": invalid identifier 


SQL> SELECT ENAME, DNAME, SAL
  2  FROM EMP E JOIN DEPT D
  3  ON E.DEPTNO = D.DEPTNO
  4  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  5  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN');

ENAME                DNAME                               SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------- ---------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
ALLEN                SALES                              1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
WARD                 SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
MARTIN               SALES                              1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
BLAKE                SALES                              2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
TURNER               SALES                              1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

SQL> SELECT DEPTNO, COUNT(*)
  2  FROM (
  3  SELECT D.DEPTNO, ENAME, DNAME, SAL
  4  FROM EMP E JOIN DEPT D
  5  ON E.DEPTNO = D.DEPTNO
  6  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  7  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  8  )
  9  GROUP BY DEPTNO
 10  ;

    DEPTNO   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT DEPTNO, COUNT(*) AS '사원수'
  2  FROM (
  3  SELECT D.DEPTNO, ENAME, DNAME, SAL
  4  FROM EMP E JOIN DEPT D
  5  ON E.DEPTNO = D.DEPTNO
  6  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  7  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  8  )
  9  GROUP BY DEPTNO
 10  ;
SELECT DEPTNO, COUNT(*) AS '사원수'
                           *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT DEPTNO, COUNT(*) AS 사원수
  2  SELECT DEPTNO, COUNT(*) AS 사원수
  3  FROM (
  4  SELECT D.DEPTNO, ENAME, DNAME, SAL
  5  FROM EMP E JOIN DEPT D
  6  ON E.DEPTNO = D.DEPTNO
  7  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  8  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  9  )
 10  GROUP BY DEPTNO
 11  ;
SELECT DEPTNO, COUNT(*) AS 사원수
   *
ERROR at line 2:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT DEPTNO, COUNT(*) AS 사원수
  2  FROM (
  3  SELECT D.DEPTNO, ENAME, DNAME, SAL
  4  FROM EMP E JOIN DEPT D
  5  ON E.DEPTNO = D.DEPTNO
  6  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  7  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  8  )
  9  GROUP BY DEPTNO
 10  ;

    DEPTNO     사원수                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT DEPTNO AS 부서번호, COUNT(*) AS 사원수
  2  FROM (
  3  SELECT D.DEPTNO, ENAME, DNAME, SAL
  4  FROM EMP E JOIN DEPT D
  5  ON E.DEPTNO = D.DEPTNO
  6  WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'MARTIN')
  7  AND SAL >= (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN')
  8  )
  9  GROUP BY DEPTNO
 10  ;

  부서번호     사원수                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT D.DEPTNO, ENAME, SAL, COMM
  2  FROM DEPT D LEFT OUTER JOIN EMP E
  3  ON D.DEPTNO = E.DEPTNO
  4  ;

    DEPTNO ENAME                       SAL       COMM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- -------------------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20 SMITH                       800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30 ALLEN                      1600        300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30 WARD                       1250        500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20 JONES                      2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30 MARTIN                     1250       1400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30 BLAKE                      2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        10 CLARK                      2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        20 SCOTT                      3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        10 KING                       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30 TURNER                     1500          0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20 ADAMS                      1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30 JAMES                       950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        20 FORD                       3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        10 MILLER                     1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

15 rows selected.

SQL> SELECT D.DEPTNO, DNAME, ENAME, SAL, COMM
  2  FROM DEPT D LEFT OUTER JOIN EMP E
  3  ON D.DEPTNO = E.DEPTNO
  4  ;

    DEPTNO DNAME                        ENAME                       SAL       COMM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
---------- ---------------------------- -------------------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        10 ACCOUNTING                   CLARK                      2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        10 ACCOUNTING                   KING                       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        10 ACCOUNTING                   MILLER                     1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     JONES                      2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     FORD                       3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     ADAMS                      1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     SMITH                       800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     SCOTT                      3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        WARD                       1250        500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        30 SALES                        TURNER                     1500          0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        30 SALES                        ALLEN                      1600        300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        30 SALES                        JAMES                       950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        BLAKE                      2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        MARTIN                     1250       1400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        40 OPERATIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

15 rows selected.

SQL> SELECT D.DEPTNO, DNAME, ENAME, SAL
  2  FROM DEPT D LEFT OUTER JOIN EMP E
  3  ON D.DEPTNO = E.DEPTNO
  4  ;

    DEPTNO DNAME                        ENAME                       SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ---------------------------- -------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        10 ACCOUNTING                   CLARK                      2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        10 ACCOUNTING                   KING                       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        10 ACCOUNTING                   MILLER                     1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     JONES                      2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     FORD                       3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     ADAMS                      1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     SMITH                       800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20 RESEARCH                     SCOTT                      3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        WARD                       1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        TURNER                     1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        ALLEN                      1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        JAMES                       950                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        BLAKE                      2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30 SALES                        MARTIN                     1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        40 OPERATIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

15 rows selected.

SQL> SELECT D.DEPTNO, SUM(SAL)
  2  FROM DEPT D LEFT OUTER JOIN EMP E
  3  ON D.DEPTNO = E.DEPTNO
  4  GROUP BY D.DEPTNO;

    DEPTNO   SUM(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        10       8750                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20      10875                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30       9400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> SELECT DNAME, SUM(SAL)
  2  FROM DEPT D LEFT OUTER JOIN EMP E
  3  ON D.DEPTNO = E.DEPTNO
  4  GROUP BY D.DEPTNO;
SELECT DNAME, SUM(SAL)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT DNAME
  2  FROM DEPT
  3  WHERE DEPTNO IN (
  4      SELECT D.DEPTNO
  5      FROM DEPT D LEFT OUTER JOIN EMP E
  6      ON D.DEPTNO = E.DEPTNO
  7      GROUP BY D.DEPTNO
  8  );

DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
OPERATIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

SQL> SELECT DNAME
  2  FROM DEPT
  3  WHERE DEPTNO IN (
  4      SELECT D.DEPTNO
  5      FROM DEPT D LEFT OUTER JOIN EMP E
  6      ON D.DEPTNO = E.DEPTNO
  7      GROUP BY D.DEPTNO
  8      HAVING SUM(SAL) >  9000
  9  );

DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
